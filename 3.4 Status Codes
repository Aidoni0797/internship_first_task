3.4 Status Codes

Статус коды
https://developer.mozilla.org/ru/docs/Web/HTTP/Reference/Status - всякий раз, когда мы совершаем запрос к URL, сервер отправляет нам код статуса запроса.
Код - это цифра, которая дает нам понять, выполнился ли запрос, а если нет, то в чем проблема.

- Информационные 100-199
- Успешные 200-299
- Перенаправления 300-399
- Клиентские ошибки 400-499
- Серверные ошибки 500-599

200 - ОК - "Успешно". Запрос успешно обработан.

В 95% случаев нас интересует код с номером 200 т.к. он гарантирует, что ответ с сервера пришел полностью и без каких-либо ограничений.

К примеру код 201 приходит в ответ на метод put()

201 - Created - "Создано". Запрос успешно выполнен и в результате был создан ресурс. Этот код обычно присылается  в ответ  на запрос PUT "ПОМЕСТИТЬ".

Используя атрибут status_code, мы можем увидеть, какой код мы получили в ответ.

import requests

url = 'http://httpbin.org/'
response = requests.get(url)
print(response.status_code)

>>>200

Попробуйте заменить URL на несуществующий, чтобы увидеть ошибку ответа 404.

Так же мы можем совершить проверку статус кода. И отталкиваясь от этого строить свой код.

import requests

url = 'http://httpbin.org/'
response = requests.get(url)
if response.status_code == 200:
  print('status_code OK')
else:
  print('status_code NOT OK')

>>> status_code OK

Это может пригодиться, когда сервер позволяет совершать определенное количество запросов за определенный промежуток времени, и, чтобы наш скрипт не падал, мы можем добавить
ожидание.

Если статус-код не равен 200, спим 60 секунд, иначе продолчаем выполнение скрипта.

import requestts
import time

url = 'http://httpbin.org/'
response = requests.get(url)
if response.status_code != 200:
  time.sleep(60)
else:
  print("status_code OK... Continue excute code...")
