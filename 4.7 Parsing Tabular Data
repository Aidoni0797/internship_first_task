4.7 Parsing Tabular Data

Парсинг табличных данных

Парсинг табличных данных ничем не отличается от прасинга других данных, за исключением того, что данные лежат в таблице. Если вы собираетесь заниматься обработкой больших данных, 
то парсингом таблицы вы будете заниматься регулярно.

Для начала нам нужно понять, как устроены таблицы в HTML. Любая табюлица состоит из табличных тегов, перечисленных ниже:

- <table></table> - служит основным тегом контейнеров для ячеек таблицы, любая таблица начинается с этого тега;
- <td></td> - (table data) - создает ячейку, в которой могут хранится любые данные;
- <th></th> - (table header) - создает ячейку-заголовок для столбца в таблице;
- <tr></tr> - (table row) - создает строку в таблице, любая таблица должна иметь хоотя бы 1 строку.

Пример таблицы с простыми ячейками <td></td>

<table>
  <tr>
    <td><b>td</b>First cell</td>
    <td><b>td</b>Second cell</td>
  </tr>
  <tr>
    <td><b>td</b>Third cell</td>
    <td><b>td</b>Fouth cell</td>
  </tr>
</table>

Пример таблицы с заголовками <th></th>

<table>
  <tr>
    <th>th - Header</th>
    <th>th - Header</th>
  </tr>
  <tr>
    <td><b>td</b>First cell</td>
    <td><b>td</b>Second cell</td>
  </tr>
  <tr>
    <td><b>td</b>Third cell</td>
    <td><b>td</b>Fourth cell</td>
  </tr>
</table>

Задание 1.
1. На сайте https://parsinger.ru/table/1/index.html расположена таблица;
2. Цель: Собрать все уникальные числа из таблицы (кроме цифр в заголовке) и суммировать их;
3. Полученный результат вставить в поле ответа.

Решение:
import requests
from bs4 import BeautifulSoup

# Получаем HTML страницу
url = "https://parsinger.ru/table/1/index.html"
response = requests.get(url)
soup = BeautifulSoup(response.text, 'html.parser')

# Находим все ячейки таблицы, кроме заголовков (<th>)
td_elements = soup.find_all('td')

# Извлекаем числа, превращаем в float и собираем уникальные
unique_numbers = set(float(td.text) for td in td_elements)

# Суммируем уникальные числа
total = sum(unique_numbers)

print(total)

--------------------------------
Задание 2

1. На сайте https://parsinger.ru/table/2/index.html расположена таблица;
2. Цель: Собрать число с 1го столбца и суммировать их;
3. Полученный результат вставить в поле ответа.

Решение

import requests
from bs4 import BeautifulSoup

url = "https://parsinger.ru/table/2/index.html"
response = requests.get(url)
soup = BeautifulSoup(response.text, "html.parser")

# Находим все строки таблицы, кроме заголовка
rows = soup.find_all('tr')[1:]  # пропускаем первую строку с заголовками

# Суммируем значения из первого столбца каждой строки
total = sum(float(row.find_all('td')[0].text) for row in rows)

print(total)

---------------------------------
Задание 3

1. На сайте https://parsinger.ru/table/3/index.html расположена таблица;
2. Цель: Собрать числа которые выделены жирным шрифтом и суммировать их;
3. Полученный результат вставить в поле ответа.

Решение

import requests
from bs4 import BeautifulSoup

url = "https://parsinger.ru/table/3/index.html"
response = requests.get(url)
soup = BeautifulSoup(response.text, "html.parser")

# Находим все элементы <b> и суммируем содержащиеся в них числа
bold_numbers = [float(b.text) for b in soup.find_all('b')]
total = sum(bold_numbers)

print(total)

